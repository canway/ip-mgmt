# 正式环境源码部署

## Fork 源代码到自己的仓库  
通过 Fork 源代码到自己的仓库，可以进行二次开发和定制。建议公共特性开发和 bug 修复通过 Pull requests 及时提交到官方仓库。如果不需要进行二次开发，请直接在 releases 中获取打包好的版本，上传部署升级官方IP管理中心 SaaS。


## 打包并收集前端静态资源
1）安装依赖包  
进入 ui/，执行以下命令安装
```bash
npm install
```

2）打包前端资源
在 ui/ 目录下，继续执行以下命令打包前端静态资源
```bash
npm run build
```


## 创建应用  
前往你部署的蓝鲸PaaS平台，在"开发者中心"点击"应用创建"，填写需要的参数，注意代码仓库填写你的 Github 仓库地址，账号和密码。


## 修改配置  
前往你部署的蓝鲸PaaS平台，在"开发者中心"点击"新手指南"，按照文档指引进行操作，主要是数据库配置修改和设置APP_ID, APP_TOKEN, BK_PAAS_HOST 等变量。


## 开通 API 白名单
手动在你部署的蓝鲸社区版的中控机执行如下命令，开通IP管理中心访问蓝鲸PaaS平台API网关的白名单，以便可以正常调用 API。
```bash
source /data/install/utils.fc
add_app_token ip-mgmt "$(_app_token ip-mgmt)" "IP管理中心"
```
注意把"IP管理中心" 和 ip-mgmt 改为你创建的应用名称和应用 ID。


## 部署应用  
前往你部署的蓝鲸PaaS平台，在"开发者中心"点击"我的应用"，找到你刚才创建的应用，点击"应用部署"，请勾选"启用celery"和"启用周期性任务"。这样你就可以在测试环境访问你新建的"IP管理中心"应用了。


