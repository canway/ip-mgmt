(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{T2sT:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=c(a("cLjf")),i=c(a("hDQ3")),r=c(a("bS4n")),s=c(a("omC7")),o=c(a("JnIg")),l=c(a("xiJ/"));function c(t){return t&&t.__esModule?t:{default:t}}e.default={name:"simul-record-manage",components:{commonTable:o.default,batchModify:l.default},data:function(){return{startTime:"",endTime:"",searchParams:[],data:[{name:"模型",id:"sync_model"},{name:"状态",id:"sync_status",children:[{name:"同步失败",id:"0"},{name:"同步成功",id:"1"},{name:"同步中",id:"2"}]}],recordDialog:{visible:!1,title:"同步记录详情"},statusObj:{0:"同步失败",1:"同步成功",2:"同步中"},formData:{model:"",create_by:"",start_time:"",end_time:"",status:""},dataList:[],columns:[{label:"模型",key:"model_name",align:"left",attr:{minWidth:"100px"}},{label:"IP",key:"ip_address",align:"left",attr:{minWidth:"100px"}},{label:"创建者",key:"create_by",align:"left",attr:{minWidth:"100px"}},{label:"开始时间",key:"sync_at",align:"left",attr:{minWidth:"100px"}},{label:"结束时间",key:"complete_at",align:"left",attr:{minWidth:"100px"}},{label:"状态",key:"sync_status",align:"left",attr:{minWidth:"100px"},scopedSlots:{customRender:"sync_status"}},{label:"操作",key:"operation",width:"100px",scopedSlots:{customRender:"operation"}}],pagination:{current:1,count:1,limit:10},batchWidgets:[{widget:"input",name:"model_name",label:"模型",required:!1,attr:{clearable:!0},disabled:!0},{widget:"input",name:"create_by",label:"创建者",required:!1,attr:{clearable:!0},disabled:!0},{widget:"input",name:"sync_at",label:"开始时间",placeholder:"请选择...",attr:{style:{width:"100%"},transfer:!0,clearable:!0},disabled:!0},{widget:"input",name:"complete_at",label:"结束时间",required:!1,attr:{clearable:!0},disabled:!0},{widget:"input",name:"old_info",label:"同步前信息",required:!1,attr:{clearable:!0,type:"textarea"},disabled:!0},{widget:"input",name:"new_info",label:"同步后信息",required:!1,attr:{clearable:!0,type:"textarea"},disabled:!0},{widget:"input",name:"sync_status_name",label:"状态",required:!1,attr:{clearable:!0},disabled:!0}],batchModifyVisible:!1,loading:!1}},computed:{getConditionData:function(){var t=this,e=JSON.parse((0,s.default)(this.data)),a=[];return e.forEach((function(e){t.searchParams.find((function(t){return t.id===e.id}))||a.push((0,r.default)({},e))})),a}},mounted:function(){this.fetchData()},methods:{handlePageChange:function(t){this.pagination.current=t,this.fetchData()},limitChange:function(t){this.pagination.limit=t,this.pagination.current=1,this.fetchData()},fetchData:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,i.default)(n.default.mark((function a(){var i;return n.default.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return t.loading=!0,a.prev=1,a.next=4,t.$api.searchSyncRecord((0,r.default)({page:t.pagination.current,page_size:t.pagination.limit},e));case 4:(i=a.sent).result?(t.pagination.count=i.data.count,t.dataList=i.data.results):t._errorMessage(i.message);case 6:return a.prev=6,t.loading=!1,a.finish(6);case 9:case"end":return a.stop()}}),a,t,[[1,,6,9]])})))()},onSearch:function(){var t=this;this.pagination.current=1;var e=setTimeout((function(){var a={model:t.getDataDetail("sync_model"),sync_status:t.getDataDetail("sync_status"),end_time:""!==t.endTime?t.$moment(t.endTime).format("YYYY-MM-DD"):t.endTime,start_time:""!==t.startTime?t.$moment(t.startTime).format("YYYY-MM-DD"):t.startTime,page:t.pagination.current,page_size:t.pagination.limit};t.fetchData(a),clearTimeout(e)}),0)},getDataDetail:function(t){var e=this.searchParams.find((function(e){return e.id===t}));return e&&e.values?e.values[0].id:""},batchDetail:function(t){var e=this;return(0,i.default)(n.default.mark((function a(){return n.default.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:e.formData=e.$Copy(t),e.formData.old_info=(0,s.default)(e.formData.old_info),e.formData.new_info=(0,s.default)(e.formData.new_info),e.formData.sync_status_name=e.statusObj[t.sync_status],e.batchModifyVisible=!0;case 5:case"end":return a.stop()}}),a,e)})))()}}}},WVj7:function(t,e,a){"use strict";a.d(e,"a",(function(){return n})),a.d(e,"b",(function(){return i}));var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"table—wrapper content"},[a("div",{staticClass:"header-table-operation"},[a("div",{staticStyle:{display:"flex","align-items":"center"}},[a("bk-search-select",{staticStyle:{width:"400px",background:"#fff","margin-right":"16px"},attrs:{clearable:"",data:t.getConditionData,"show-condition":!1,"show-popover-tag-change":!0},on:{search:t.onSearch,clear:t.onSearch},model:{value:t.searchParams,callback:function(e){t.searchParams=e},expression:"searchParams"}}),t._v(" "),a("span",[t._v("开始时间：")]),t._v(" "),a("bk-date-picker",{staticStyle:{width:"180px","margin-right":"16px"},attrs:{placeholder:"选择日期"},on:{change:t.onSearch},model:{value:t.startTime,callback:function(e){t.startTime=e},expression:"startTime"}}),t._v(" "),a("span",[t._v("结束时间：")]),t._v(" "),a("bk-date-picker",{staticStyle:{width:"180px","margin-right":"16px"},attrs:{placeholder:"选择日期"},on:{change:t.onSearch},model:{value:t.endTime,callback:function(e){t.endTime=e},expression:"endTime"}})],1)]),t._v(" "),a("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:t.loading,zIndex:10},expression:"{ isLoading: loading, zIndex: 10 }"}]},[a("common-table",{attrs:{data:t.dataList,columns:t.columns,"order-column":{visible:!1,fixed:!1},pagination:t.pagination},on:{"page-change":t.handlePageChange,"page-limit-change":t.limitChange},scopedSlots:t._u([{key:"sync_status",fn:function(e){return[t._v("\n                "+t._s(t.statusObj[e.scope.sync_status])+"\n            ")]}},{key:"operation",fn:function(e){return[a("bk-button",{staticClass:"mr10",attrs:{theme:"primary",text:""},on:{click:function(a){return t.batchDetail(e.scope)}}},[t._v("详情")])]}}])})],1),t._v(" "),a("batch-modify",{attrs:{"form-data":t.formData,"is-show-footer":!1,"form-widgets":t.batchWidgets,title:"同步记录详情"},model:{value:t.batchModifyVisible,callback:function(e){t.batchModifyVisible=e},expression:"batchModifyVisible"}})],1)},i=[]},XRWL:function(t,e,a){"use strict";a.r(e);var n=a("T2sT"),i=a.n(n);for(var r in n)["default"].indexOf(r)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(r);e.default=i.a},tni5:function(t,e,a){"use strict";a.r(e);var n=a("WVj7"),i=a("XRWL");for(var r in i)["default"].indexOf(r)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(r);var s=a("y6gh"),o=Object(s.a)(i.default,n.a,n.b,!1,null,null,null);e.default=o.exports}}]);
//# sourceMappingURL=14.9695c70cf8fa1b60df04.js.map