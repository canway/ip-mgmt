(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{"+ioc":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=l(a("cLjf")),r=l(a("bS4n")),n=l(a("hDQ3")),o=l(a("JnIg")),s=l(a("xiJ/"));function l(e){return e&&e.__esModule?e:{default:e}}t.default={name:"operation-record-manage",components:{commonTable:o.default,batchModify:s.default},data:function(){return{dateRange:"",startTime:"",endTime:"",searchParams:{},operationType:[{id:"add",name:"新增"},{id:"modify",name:"修改"},{id:"exec",name:"执行"},{id:"delete",name:"删除"}],operateTypeObj:{add:"新增",modify:"修改",exec:"执行",delete:"删除"},customDialog:{visible:!1,title:"添加自定义属性"},dataList:[],columns:[{label:"操作人",key:"operator",align:"left",attr:{minWidth:"100px"}},{label:"操作对象",key:"operate_obj",align:"left",attr:{minWidth:"100px"}},{label:"操作类型",key:"operate_type",align:"left",attr:{minWidth:"100px"},scopedSlots:{customRender:"operate_type"}},{label:"操作时间",key:"operate_date",align:"left",attr:{minWidth:"100px"}},{label:"操作概要",key:"operate_detail",align:"left",attr:{minWidth:"100px"}},{label:"操作",key:"operation",width:"100px",scopedSlots:{customRender:"operation"}}],pagination:{current:1,count:1,limit:10},formData:{operator:"",operate_obj:"",operate_type:"",operate_date:"",operate_detail:""},batchWidgets:[{widget:"input",name:"operator",label:"操作人",required:!1,attr:{clearable:!0},disabled:!0},{widget:"input",name:"operate_obj",label:"操作对象",required:!1,attr:{clearable:!0},disabled:!0},{widget:"input",name:"operate_type",label:"操作类型",attr:{clearable:!0},disabled:!0},{widget:"input",name:"operate_date",label:"操作时间",required:!1,attr:{clearable:!0},disabled:!0},{widget:"input",name:"operate_detail",label:"操作概要",required:!1,attr:{clearable:!0},disabled:!0},{widget:"input",name:"operate_result",label:"操作结果",required:!1,attr:{clearable:!0},disabled:!0}],batchModifyVisible:!1,loading:!1}},watch:{dateRange:{handler:function(e){this.startTime=e[0]?this.$moment(e[0]).format("YYYY-MM-DD"):"",this.endTime=e[1]?this.$moment(e[1]).format("YYYY-MM-DD"):""}}},mounted:function(){this.fetchData()},methods:{handlePageChange:function(e){this.pagination.current=e;var t={operator:this.searchParams.operator||"",operate_type:this.searchParams.operate_type||"",end_time:this.endTime,start_time:this.startTime,page:this.pagination.current,page_size:this.pagination.limit};this.fetchData(t)},limitChange:function(e){this.pagination.limit=e,this.fetchData()},fetchData:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.default)(i.default.mark((function a(){var n;return i.default.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return e.loading=!0,a.prev=1,a.next=4,e.$api.searchOperationRecord((0,r.default)({page:e.pagination.current,page_size:e.pagination.limit},t));case 4:(n=a.sent).result?(e.pagination.count=n.data.count,e.dataList=n.data.results):e._errorMessage(n.message);case 6:return a.prev=6,e.loading=!1,a.finish(6);case 9:case"end":return a.stop()}}),a,e,[[1,,6,9]])})))()},onSearch:function(e){"clearn"===e&&(this.searchParams.operator="",this.searchParams.operate_type="",this.dateRange="",this.endTime="",this.startTime=""),this.pagination.current=1;var t={operator:this.searchParams.operator||"",operate_type:this.searchParams.operate_type||"",end_time:this.endTime,start_time:this.startTime,page:this.pagination.current,page_size:this.pagination.limit};this.fetchData(t)},batchDetail:function(e){var t=this;return(0,n.default)(i.default.mark((function a(){return i.default.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:t.batchModifyVisible=!0,t.formData=e,t.formData.operate_result=e.result?"成功":"失败";case 3:case"end":return a.stop()}}),a,t)})))()}}}},"L/jG":function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return r}));var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"table—wrapper content"},[a("div",{staticClass:"header-table-operation"},[a("div",{staticStyle:{display:"flex","align-items":"center"}},[a("span",{staticStyle:{"margin-right":"5px"}},[e._v("操作者")]),e._v(" "),a("bk-input",{staticStyle:{width:"200px","margin-right":"16px"},attrs:{clearable:!0},model:{value:e.searchParams.operator,callback:function(t){e.$set(e.searchParams,"operator",t)},expression:"searchParams.operator"}}),e._v(" "),a("span",{staticStyle:{"margin-right":"5px"}},[e._v("操作类型")]),e._v(" "),a("bk-select",{staticStyle:{width:"200px","background-color":"#FFF","margin-right":"16px"},attrs:{disabled:!1,"ext-cls":"select-custom","ext-popover-cls":"select-popover-custom"},model:{value:e.searchParams.operate_type,callback:function(t){e.$set(e.searchParams,"operate_type",t)},expression:"searchParams.operate_type"}},e._l(e.operationType,(function(e){return a("bk-option",{key:e.id,attrs:{id:e.id,name:e.name}})})),1),e._v(" "),a("span",{staticStyle:{"margin-right":"5px"}},[e._v("时间范围")]),e._v(" "),a("bk-date-picker",{staticStyle:{"margin-right":"16px"},attrs:{placeholder:"选择日期范围",type:"daterange"},model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}}),e._v(" "),a("bk-button",{staticStyle:{"margin-right":"8px"},attrs:{title:"搜索"},on:{click:e.onSearch}},[e._v("搜索")]),e._v(" "),a("bk-button",{staticClass:"mr10",attrs:{title:"重置"},on:{click:function(t){return e.onSearch("clearn")}}},[e._v("重置")])],1)]),e._v(" "),a("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.loading,zIndex:10},expression:"{ isLoading: loading, zIndex: 10 }"}]},[a("common-table",{attrs:{data:e.dataList,columns:e.columns,"order-column":{visible:!1,fixed:!1},pagination:e.pagination},on:{"page-change":e.handlePageChange,"page-limit-change":e.limitChange},scopedSlots:e._u([{key:"operate_type",fn:function(t){return[e._v("\n                "+e._s(e.operateTypeObj[t.scope.operate_type])+"\n            ")]}},{key:"operation",fn:function(t){return[a("bk-button",{staticClass:"mr10",attrs:{theme:"primary",text:""},on:{click:function(a){return e.batchDetail(t.scope)}}},[e._v("详情")])]}}])})],1),e._v(" "),a("batch-modify",{attrs:{"form-data":e.formData,"is-show-footer":!1,"form-widgets":e.batchWidgets,title:"操作记录详情"},model:{value:e.batchModifyVisible,callback:function(t){e.batchModifyVisible=t},expression:"batchModifyVisible"}})],1)},r=[]},MwYn:function(e,t,a){"use strict";a.r(t);var i=a("L/jG"),r=a("YhMc");for(var n in r)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return r[e]}))}(n);var o=a("y6gh"),s=Object(o.a)(r.default,i.a,i.b,!1,null,null,null);t.default=s.exports},YhMc:function(e,t,a){"use strict";a.r(t);var i=a("+ioc"),r=a.n(i);for(var n in i)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(n);t.default=r.a}}]);
//# sourceMappingURL=13.b9fb275c0f1958f100c1.js.map