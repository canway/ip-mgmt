{"version":3,"sources":["webpack:///./src/views/system/CMDB.vue","webpack:///./src/views/system/CMDB.vue?da26","webpack:///src/views/system/CMDB.vue","webpack:///./src/views/system/CMDB.vue?2209"],"names":["component","render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","on","onSearch","model","value","callback","$$v","searchValue","expression","_v","setPeriod","addModel","directives","name","rawName","isLoading","loading","zIndex","dataList","columns","visible","fixed","pagination","handlePageChange","limitChange","scopedSlots","_u","key","fn","record","_s","syncObject","scope","sync","$event","toSync","toMap","toDelete","periodSettingVisible","ref","editPeriod","syncRules","$set","staticStyle","_l","option","id","slot","isConfirm","stopPropagation","preventDefault","periodSubmit","apply","arguments","modelVisible","modelFormData","rules","changeClick","model_id","bk_property_id","bk_property_name","modelSubmit","mapVisible","item","index","reduceMap","_e","addMap","newVaule","CMDBClick","mapSubmit","staticRenderFns"],"mappings":"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","file":"static/dist/js/10.86381494843fd2f0c6c3.js","sourcesContent":["import { render, staticRenderFns } from \"./CMDB.vue?vue&type=template&id=10559522&scoped=true&\"\nimport script from \"./CMDB.vue?vue&type=script&lang=js&\"\nexport * from \"./CMDB.vue?vue&type=script&lang=js&\"\nimport style0 from \"./CMDB.vue?vue&type=style&index=0&id=10559522&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"10559522\",\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../node_modules/_babel-loader@7.1.5@babel-loader/lib/index.js!../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/index.js??vue-loader-options!./CMDB.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/_babel-loader@7.1.5@babel-loader/lib/index.js!../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/index.js??vue-loader-options!./CMDB.vue?vue&type=script&lang=js&\"","<!--\r\nThis program is named IP Management Center and it is a tool to help network administrators manage enterprise IP resource pool reasonably and conveniently.\r\nCopyright (C) <2021>  <Guangzhou Canway Technology Co.,Ltd.>\r\nContact details: jackliu@canway.net or 11th Floor, Building A，Fengxing Plaza No. 67 Tianhe East Road Tianhe District, Guangzhou, China 510630. jackliu, 15927493530\r\nThis file is part of IP Management Center.\r\nIP Management Center is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.\r\nIP Management Center is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.\r\nYou should have received a copy of the GNU General Public License along with Canway software. If not, see <https://www.gnu.org/licenses/>.\r\n-->\r\n<template>\r\n    <div class=\"table—wrapper content\">\r\n        <div class=\"header-table-operation\">\r\n            <search-input\r\n                v-model=\"searchValue\"\r\n                :placeholder=\"'请输入模型名称'\"\r\n                @search=\"onSearch\">\r\n            </search-input>\r\n            <div class=\"operation-container\">\r\n                <div>\r\n                    <bk-button :title=\"'同步周期'\" @click=\"setPeriod\">\r\n                        同步周期\r\n                    </bk-button>\r\n                    <bk-button :title=\"'新增模型'\" @click=\"addModel\">\r\n                        新增模型\r\n                    </bk-button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div v-bkloading=\"{ isLoading: loading, zIndex: 10 }\">\r\n            <common-table\r\n                :data=\"dataList\"\r\n                :columns=\"columns\"\r\n                :select-column=\"{ visible: false, fixed: false }\"\r\n                :order-column=\"{ visible: false, fixed: false }\"\r\n                :pagination=\"pagination\"\r\n                @page-change=\"handlePageChange\"\r\n                @page-limit-change=\"limitChange\"\r\n            >\r\n                <template slot=\"sync\" slot-scope=\"record\">\r\n                    {{ syncObject[record.scope.sync] }}\r\n                </template>\r\n                <template slot=\"operation\" slot-scope=\"record\">\r\n                    <bk-button class=\"mr10\" theme=\"primary\" text @click=\"toSync(record.scope)\">同步</bk-button>\r\n                    <bk-button class=\"mr10\" theme=\"primary\" text @click=\"toMap(record.scope)\">属性映射</bk-button>\r\n                    <bk-popconfirm\r\n                        trigger=\"click\"\r\n                        title=\"确认删除该名单？\"\r\n                        content=\"删除操作无法撤回，请谨慎操作！\"\r\n                        @confirm=\"toDelete(record.scope)\">\r\n                        <bk-button class=\"mr10\" theme=\"primary\" text>剔除</bk-button>\r\n                    </bk-popconfirm>\r\n                </template>\r\n            </common-table>\r\n        </div>\r\n        <bk-dialog v-model=\"periodSettingVisible\"\r\n            theme=\"primary\"\r\n            :mask-close=\"false\"\r\n            :header-position=\"'left'\"\r\n            title=\"同步周期设置\">\r\n            <bk-form :label-width=\"80\" :model=\"editPeriod\" :rules=\"syncRules\" ref=\"validateForm\">\r\n                <bk-form-item label=\"同步时间\" :required=\"true\" :property=\"'last_time'\" :error-display-type=\"'normal'\">\r\n                    <bk-date-picker v-model=\"editPeriod.last_time\" :placeholder=\"'选择日期时间'\" :type=\"'datetime'\"></bk-date-picker>\r\n                </bk-form-item>\r\n                <bk-form-item style=\"float: left; width: 180px;\" label=\"同步周期\" :required=\"true\" :property=\"'period'\" :error-display-type=\"'normal'\">\r\n                    <bk-input v-model=\"editPeriod.period\"></bk-input>\r\n                </bk-form-item>\r\n                <bk-form-item style=\"float: left; width: 150px;\" class=\"sync-period\" label=\"\" :property=\"'value'\">\r\n                    <div style=\"float: left;\">\r\n                        <bk-select :clearable=\"false\" :disabled=\"false\" v-model=\"editPeriod.value\" style=\"width: 150px;margin-left: 10px;\"\r\n                            ext-cls=\"select-custom\"\r\n                            ext-popover-cls=\"select-popover-custom\">\r\n                            <bk-option v-for=\"option in periodList\"\r\n                                :key=\"option.id\"\r\n                                :id=\"option.id\"\r\n                                :name=\"option.name\">\r\n                            </bk-option>\r\n                        </bk-select>\r\n                    </div>\r\n                </bk-form-item>\r\n            </bk-form>\r\n            <div slot=\"footer\">\r\n                <bk-button theme=\"primary\" title=\"确定\"\r\n                    :loading=\"isConfirm\" @click.stop.prevent=\"periodSubmit\">确定</bk-button>\r\n                <bk-button theme=\"default\" title=\"取消\" @click=\"periodSettingVisible = false\">\r\n                    取消\r\n                </bk-button>\r\n            </div>\r\n        </bk-dialog>\r\n        <bk-dialog v-model=\"modelVisible\"\r\n            theme=\"primary\"\r\n            :mask-close=\"false\"\r\n            :header-position=\"'left'\"\r\n            title=\"新增模型\">\r\n            <bk-form :label-width=\"130\" :model=\"modelFormData\" :rules=\"rules\" ref=\"CMDBForm\">\r\n                <bk-form-item\r\n                    label=\"选择模型\"\r\n                    :required=\"true\"\r\n                    :property=\"'model_id'\"\r\n                    :error-display-type=\"'normal'\">\r\n                    <bk-select :disabled=\"false\" ref=\"modeSelect\" v-model=\"modelFormData.model_id\" style=\"width: 222px;\"\r\n                        ext-cls=\"select-custom\"\r\n                        ext-popover-cls=\"select-popover-custom\"\r\n                        @change=\"changeClick\"\r\n                        searchable>\r\n                        <bk-option v-for=\"option in CMDBList\"\r\n                            :key=\"option.model_id\"\r\n                            :id=\"option.model_id\"\r\n                            :name=\"option.name\">\r\n                        </bk-option>\r\n                    </bk-select>\r\n                </bk-form-item>\r\n                <bk-form-item label=\"指定IP字段\" :required=\"true\" :property=\"'ip'\" :error-display-type=\"'normal'\">\r\n                    <bk-select :disabled=\"false\" v-model=\"modelFormData.ip\" style=\"width: 222px;\"\r\n                        ext-cls=\"select-custom\"\r\n                        ext-popover-cls=\"select-popover-custom\"\r\n                    >\r\n                        <bk-option v-for=\"option in ipList\"\r\n                            :key=\"option.bk_property_id\"\r\n                            :id=\"option.bk_property_id\"\r\n                            :name=\"option.bk_property_name\">\r\n                        </bk-option>\r\n                    </bk-select>\r\n                </bk-form-item>\r\n                <bk-form-item label=\"指定云区域字段\" :property=\"'bk_cloud_id'\">\r\n                    <bk-select :disabled=\"false\" v-model=\"modelFormData.bk_cloud_id\" style=\"width: 222px;\"\r\n                        ext-cls=\"select-custom\"\r\n                        ext-popover-cls=\"select-popover-custom\"\r\n                    >\r\n                        <bk-option v-for=\"option in cloudList\"\r\n                            :key=\"option.bk_property_id\"\r\n                            :id=\"option.bk_property_id\"\r\n                            :name=\"option.bk_property_name\">\r\n                        </bk-option>\r\n                    </bk-select>\r\n                </bk-form-item>\r\n                <bk-form-item label=\"同步优先级\" :required=\"true\" :property=\"'priority'\" :error-display-type=\"'normal'\">\r\n                    <bk-input v-model=\"modelFormData.priority\" placeholder=\"仅支持数字，且优先级唯一\"></bk-input>\r\n                </bk-form-item>\r\n                <bk-form-item label=\"启动同步\" :required=\"true\" :property=\"'sync'\" :error-display-type=\"'normal'\">\r\n                    <bk-switcher v-model=\"modelFormData.sync\"></bk-switcher>\r\n                </bk-form-item>\r\n            </bk-form>\r\n            <div slot=\"footer\">\r\n                <bk-button theme=\"primary\" title=\"确定\"\r\n                    :loading=\"isConfirm\" @click.stop.prevent=\"modelSubmit\">确定</bk-button>\r\n                <bk-button theme=\"default\" title=\"取消\" @click=\"modelVisible = false\">\r\n                    取消\r\n                </bk-button>\r\n            </div>\r\n        </bk-dialog>\r\n        <bk-dialog v-model=\"mapVisible\"\r\n            theme=\"primary\"\r\n            :mask-close=\"false\"\r\n            :header-position=\"'left'\"\r\n            title=\"属性映射\">\r\n            <table style=\"text-align: center;\">\r\n                <tr>\r\n                    <td></td>\r\n                    <td width=\"100px\">IPAM属性</td>\r\n                    <td></td>\r\n                    <td>CMDB属性</td>\r\n                    <td>同步冲突检测</td>\r\n                </tr>\r\n                <tr v-for=\"(item, index) in mapList\" :key=\"index\">\r\n                    <td style=\"text-align: right;\">\r\n                        <bk-icon type=\"minus-circle\" @click=\"reduceMap(index)\" v-if=\"index !== 0\" />\r\n                        <bk-icon type=\"plus-circle\" @click=\"addMap(index)\" />\r\n                    </td>\r\n                    <td>\r\n                        <bk-select :disabled=\"false\" v-model=\"item.ipam_attr\" style=\"width: 100px;\"\r\n                            ext-cls=\"select-custom\"\r\n                            ext-popover-cls=\"select-popover-custom\"\r\n                            searchable>\r\n                            <bk-option v-for=\"option in IPAMList\"\r\n                                :key=\"option.bk_property_id\"\r\n                                :id=\"option.bk_property_id\"\r\n                                :name=\"option.bk_property_id\">\r\n                            </bk-option>\r\n                        </bk-select>\r\n                    </td>\r\n                    <td><bk-icon type=\"arrows-left\" /></td>\r\n                    <td>\r\n                        <bk-select :disabled=\"false\" v-model=\"item.cmdb_attr\" style=\"width: 100px;\"\r\n                            ext-cls=\"select-custom\"\r\n                            ext-popover-cls=\"select-popover-custom\"\r\n                            searchable\r\n                            @change=\"(newVaule) => CMDBClick(newVaule, item)\">\r\n                            <bk-option v-for=\"option in attrList\"\r\n                                :key=\"option.bk_property_id\"\r\n                                :id=\"option.bk_property_id\"\r\n                                :name=\"option.bk_property_name\">\r\n                            </bk-option>\r\n                        </bk-select>\r\n                    </td>\r\n                    <td>\r\n                        <bk-checkbox\r\n                            v-model=\"item.check_conflict\">\r\n                        </bk-checkbox>\r\n                    </td>\r\n                </tr>\r\n            </table>\r\n            <div slot=\"footer\">\r\n                <bk-button theme=\"primary\" title=\"保存\"\r\n                    :loading=\"isConfirm\" @click.stop.prevent=\"mapSubmit\">保存</bk-button>\r\n                <bk-button theme=\"default\" title=\"取消\" @click=\"mapVisible = false\">\r\n                    取消\r\n                </bk-button>\r\n            </div>\r\n        </bk-dialog>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    import commonTable from '@/components/table/comTable'\r\n    import searchInput from '@/components/searchInput'\r\n    export default {\r\n        name: 'c-m-d-b-manage',\r\n        components: {\r\n            commonTable,\r\n            searchInput\r\n        },\r\n        data() {\r\n            return {\r\n                userDialog: {\r\n                    visible: false,\r\n                    title: '新增用户'\r\n                },\r\n                periodSettingVisible: false,\r\n                modelVisible: false,\r\n                periodFormData: {},\r\n                editPeriod: {\r\n                    last_time: '',\r\n                    value: 'd',\r\n                    period: ''\r\n                },\r\n                modelFormData: {\r\n                    model_id: '',\r\n                    priority: '',\r\n                    sync: true,\r\n                    ip: '',\r\n                    bk_cloud_id: '',\r\n                    attribute_map: [\r\n                        {\r\n                            ipam_attr: 'ip',\r\n                            cmdb_attr: '',\r\n                            is_cmdb_enum: false,\r\n                            check_conflict: true\r\n                        },\r\n                        {\r\n                            ipam_attr: 'bk_cloud_id',\r\n                            cmdb_attr: '',\r\n                            is_cmdb_enum: false,\r\n                            check_conflict: true\r\n                        }\r\n                    ]\r\n                },\r\n                searchValue: '',\r\n                periodList: [\r\n                    {\r\n                        id: 'd',\r\n                        name: '天'\r\n                    },\r\n                    {\r\n                        id: 'h',\r\n                        name: '小时'\r\n                    }\r\n                ],\r\n                cloudList: [],\r\n                ipList: [],\r\n                dataList: [],\r\n                syncObject: {\r\n                    true: '是',\r\n                    false: '否'\r\n                },\r\n                CMDBList: [],\r\n                attrList: [],\r\n                columns: [\r\n                    {\r\n                        label: '模型名称',\r\n                        key: 'name',\r\n                        align: 'left',\r\n                        attr: {\r\n                            minWidth: '100px'\r\n                        }\r\n                    },\r\n                    {\r\n                        label: '模型ID',\r\n                        key: 'model_id',\r\n                        align: 'left',\r\n                        attr: {\r\n                            minWidth: '100px'\r\n                        }\r\n                    },\r\n                    {\r\n                        label: '同步优先级',\r\n                        key: 'priority',\r\n                        align: 'left',\r\n                        attr: {\r\n                            minWidth: '100px'\r\n                        }\r\n                    },\r\n                    {\r\n                        label: '云区域字段',\r\n                        key: 'bk_cloud_id',\r\n                        align: 'left',\r\n                        attr: {\r\n                            minWidth: '100px'\r\n                        }\r\n                    },\r\n                    {\r\n                        label: 'IP字段',\r\n                        key: 'ip',\r\n                        align: 'left',\r\n                        attr: {\r\n                            minWidth: '100px'\r\n                        }\r\n                    },\r\n                    {\r\n                        label: '启动同步',\r\n                        key: 'sync',\r\n                        align: 'left',\r\n                        attr: {\r\n                            minWidth: '60px'\r\n                        },\r\n                        scopedSlots: { customRender: 'sync' }\r\n                    },\r\n                    {\r\n                        label: '操作',\r\n                        key: 'operation',\r\n                        attr: {\r\n                            minWidth: '170px'\r\n                        },\r\n                        scopedSlots: { customRender: 'operation' }\r\n                    }\r\n                ],\r\n                pagination: {\r\n                    current: 1,\r\n                    count: 1,\r\n                    limit: 10\r\n                },\r\n                IPAMList: [],\r\n                rules: {\r\n                    model_id: [\r\n                        {\r\n                            required: true,\r\n                            message: '请选择模型',\r\n                            trigger: 'change'\r\n                        }\r\n                    ],\r\n                    ip: [\r\n                        {\r\n                            required: true,\r\n                            message: '请选择指定IP字段',\r\n                            trigger: 'change'\r\n                        }\r\n                    ],\r\n                    priority: [\r\n                        {\r\n                            required: true,\r\n                            message: '请输入同步优先级',\r\n                            trigger: 'blur'\r\n                        }\r\n                    ]\r\n                },\r\n                syncRules: {\r\n                    last_time: [\r\n                        {\r\n                            required: true,\r\n                            message: '请选择同步时间',\r\n                            trigger: 'change'\r\n                        }\r\n                    ],\r\n                    period: [\r\n                        {\r\n                            required: true,\r\n                            message: '请选择同步周期',\r\n                            trigger: 'blur'\r\n                        }\r\n                    ]\r\n                },\r\n                loading: false,\r\n                isConfirm: false,\r\n                mapVisible: false,\r\n                mapList: [],\r\n                defaultList: [\r\n                    {\r\n                        ipam_attr: 'ip',\r\n                        cmdb_attr: 'bk_host_innerip',\r\n                        is_cmdb_enum: false,\r\n                        check_conflict: true\r\n                    },\r\n                    {\r\n                        ipam_attr: 'bk_cloud_id',\r\n                        cmdb_attr: 'bk_cloud_id',\r\n                        is_cmdb_enum: false,\r\n                        check_conflict: true\r\n                    },\r\n                    {\r\n                        ipam_attr: 'dns',\r\n                        cmdb_attr: 'dns_serv',\r\n                        is_cmdb_enum: false,\r\n                        check_conflict: false\r\n                    }\r\n                ],\r\n                mapId: null\r\n            }\r\n        },\r\n        watch: {\r\n            'periodSettingVisible'() {\r\n                if (!this.periodSettingVisible) {\r\n                    this.periodFormData = {}\r\n                }\r\n            },\r\n            'modelVisible'() {\r\n                if (!this.modelVisible) {\r\n                    this.modelFormData = {\r\n                        model_id: '',\r\n                        priority: '',\r\n                        sync: true,\r\n                        ip: '',\r\n                        bk_cloud_id: '',\r\n                        attribute_map: [\r\n                            {\r\n                                ipam_attr: 'ip',\r\n                                cmdb_attr: '',\r\n                                is_cmdb_enum: false,\r\n                                check_conflict: true\r\n                            },\r\n                            {\r\n                                ipam_attr: 'bk_cloud_id',\r\n                                cmdb_attr: '',\r\n                                is_cmdb_enum: false,\r\n                                check_conflict: true\r\n                            }\r\n                        ]\r\n                    }\r\n                }\r\n            },\r\n            'mapVisible'() {\r\n                if (!this.mapVisible) {\r\n                    this.mapList = []\r\n                }\r\n            },\r\n            searchValue(newV) {\r\n                if (!newV) {\r\n                    this.onSearch()\r\n                }\r\n            }\r\n        },\r\n        created() {\r\n            this.fetchData()\r\n        },\r\n        methods: {\r\n            handlePageChange(page) {\r\n                this.pagination.current = page\r\n                this.fetchData()\r\n            },\r\n            limitChange(limit) {\r\n                this.pagination.limit = limit\r\n                this.pagination.current = 1\r\n                this.fetchData()\r\n            },\r\n            // 查询模型\r\n            async fetchData(params = {}) {\r\n                this.loading = true\r\n                try {\r\n                    const res = await this.$api.searchCMDB({\r\n                        page: this.pagination.current,\r\n                        page_size: this.pagination.limit,\r\n                        ...params\r\n                    })\r\n                    if (res.result) {\r\n                        this.dataList = res.data.results\r\n                        this.pagination.count = res.data.count\r\n                    } else {\r\n                        this._errorMessage(res.message)\r\n                    }\r\n                } finally {\r\n                    this.loading = false\r\n                }\r\n            },\r\n            onSearch(value) {\r\n                this.pagination.current = 1\r\n                this.fetchData({\r\n                    search: value\r\n                })\r\n            },\r\n            async toDelete(row) {\r\n                const res = await this.$api.deleteCMDB({id: row.id})\r\n                if (res.result) {\r\n                    this._successMessage('删除成功')\r\n                    if (this.pagination.current > 1 && this.dataList.length === 1) {\r\n                        this.pagination.current--\r\n                    }\r\n                    this.fetchData()\r\n                } else {\r\n                    this._errorMessage(res.message)\r\n                }\r\n            },\r\n            async periodSubmit() {\r\n                this.$refs.validateForm.validate().then((valid) => {\r\n                    if (valid) {\r\n                        this.isConfirm = true\r\n                        this.periodFormData.last_time = this.editPeriod.last_time\r\n                        this.periodFormData.period = this.editPeriod.period + this.editPeriod.value\r\n                        this.$api.setCMDBPeriod(this.periodFormData).then(res => {\r\n                            if (res.result) {\r\n                                this._successMessage('设置同步周期成功')\r\n                                this.fetchData()\r\n                                this.periodSettingVisible = false\r\n                            } else {\r\n                                this._errorMessage(res.message)\r\n                            }\r\n                        }).finally(() => {\r\n                            this.isConfirm = false\r\n                        })\r\n                    }\r\n                }, validator => {\r\n                    this.isConfirm = false\r\n                })\r\n            },\r\n            modelSubmit() {\r\n                this.modelFormData.attribute_map[0].cmdb_attr = this.modelFormData.ip\r\n                this.modelFormData.attribute_map[1].cmdb_attr = this.modelFormData.bk_cloud_id\r\n                this.modelFormData.name = this.$refs.modeSelect.selectedName\r\n                this.isConfirm = true\r\n                this.$refs.CMDBForm.validate().then((valid) => {\r\n                    if (valid) {\r\n                        this.$api.addCMDB(this.modelFormData).then(res => {\r\n                            if (res.result) {\r\n                                this._successMessage('新增成功')\r\n                                this.fetchData()\r\n                                this.modelVisible = false\r\n                            } else {\r\n                                this._errorMessage(res.message)\r\n                            }\r\n                        }).finally(() => {\r\n                            this.isConfirm = false\r\n                        })\r\n                    }\r\n                }, validator => {\r\n                    this.isConfirm = false\r\n                })\r\n            },\r\n            async toSync(row) {\r\n                const res = await this.$api.makeSync({id: row.id})\r\n                if (res.result) {\r\n                    this._successMessage('手动同步成功')\r\n                    this.fetchData()\r\n                } else {\r\n                    this._errorMessage(res.message)\r\n                }\r\n            },\r\n            async changeClick(newValue) {\r\n                const res = await this.$api.selectCMDBAttr({model: newValue})\r\n                this.ipList = res.data\r\n                this.cloudList = res.data\r\n                this.modelFormData.ip = ''\r\n                this.modelFormData.bk_cloud_id = ''\r\n                this.modelFormData.priority = ''\r\n            },\r\n            async onSearchCMDB() {\r\n                const res = await this.$api.selectCMDB()\r\n                if (res.result) {\r\n                    this.CMDBList = res.data\r\n                }\r\n            },\r\n            addModel() {\r\n                this.modelVisible = true\r\n                this.onSearchCMDB()\r\n            },\r\n            reduceMap(index) {\r\n                this.mapList.splice(index, 1)\r\n            },\r\n            addMap(index) {\r\n                const item = {\r\n                    ipam_attr: '',\r\n                    cmdb_attr: '',\r\n                    is_cmdb_enum: false,\r\n                    check_conflict: false\r\n                }\r\n                this.mapList.splice(index + 1, 0, item)\r\n            },\r\n            async setPeriod() {\r\n                this.periodSettingVisible = true\r\n                const res = await this.$api.searchCMDBPeriod()\r\n                if (res.result) {\r\n                    this.periodFormData = res.data\r\n                    this.editPeriod.last_time = this.periodFormData.last_time\r\n                    this.editPeriod.period = parseInt(this.periodFormData.period)\r\n                    this.editPeriod.value = this.periodFormData.period.charAt(this.periodFormData.period.length - 1)\r\n                } else {\r\n                    this._errorMessage(res.message)\r\n                }\r\n            },\r\n            async toMap(row) {\r\n                this.mapId = row.id\r\n                this.mapVisible = true\r\n                const res = await this.$api.getCMDBMap({id: row.id})\r\n                if (res.result) {\r\n                    this.IPAMList = res.data.IPAM\r\n                    this.attrList = res.data.CMDB\r\n                    if (res.data.attribute_map !== []) {\r\n                        this.mapList = res.data.attribute_map\r\n                    } else {\r\n                        this.mapList = this.defaultList\r\n                    }\r\n                } else {\r\n                    this._errorMessage(res.message)\r\n                }\r\n            },\r\n            mapSubmit() {\r\n                this.$api.updateCMDBMap({\r\n                    id: this.mapId,\r\n                    attribute_map: this.mapList\r\n                }).then(res => {\r\n                    if (res.result) {\r\n                        this._successMessage('更新属性映射成功')\r\n                        this.mapVisible = false\r\n                        this.onSearch()\r\n                    } else {\r\n                        this._errorMessage(res.message)\r\n                    }\r\n                })\r\n            },\r\n            CMDBClick(newValue, item) {\r\n                const _current = this.attrList.find(data => data.bk_property_id === newValue)\r\n                item['is_cmdb_enum'] = _current['is_cmdb_enum']\r\n            }\r\n        }\r\n    }\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n/deep/.sync-period {\r\n    .bk-form-content {\r\n        margin-left: 0 !important;\r\n    }\r\n}\r\n</style>\r\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"table—wrapper content\"},[_c('div',{staticClass:\"header-table-operation\"},[_c('search-input',{attrs:{\"placeholder\":'请输入模型名称'},on:{\"search\":_vm.onSearch},model:{value:(_vm.searchValue),callback:function ($$v) {_vm.searchValue=$$v},expression:\"searchValue\"}}),_vm._v(\" \"),_c('div',{staticClass:\"operation-container\"},[_c('div',[_c('bk-button',{attrs:{\"title\":'同步周期'},on:{\"click\":_vm.setPeriod}},[_vm._v(\"\\n                    同步周期\\n                \")]),_vm._v(\" \"),_c('bk-button',{attrs:{\"title\":'新增模型'},on:{\"click\":_vm.addModel}},[_vm._v(\"\\n                    新增模型\\n                \")])],1)])],1),_vm._v(\" \"),_c('div',{directives:[{name:\"bkloading\",rawName:\"v-bkloading\",value:({ isLoading: _vm.loading, zIndex: 10 }),expression:\"{ isLoading: loading, zIndex: 10 }\"}]},[_c('common-table',{attrs:{\"data\":_vm.dataList,\"columns\":_vm.columns,\"select-column\":{ visible: false, fixed: false },\"order-column\":{ visible: false, fixed: false },\"pagination\":_vm.pagination},on:{\"page-change\":_vm.handlePageChange,\"page-limit-change\":_vm.limitChange},scopedSlots:_vm._u([{key:\"sync\",fn:function(record){return [_vm._v(\"\\n                \"+_vm._s(_vm.syncObject[record.scope.sync])+\"\\n            \")]}},{key:\"operation\",fn:function(record){return [_c('bk-button',{staticClass:\"mr10\",attrs:{\"theme\":\"primary\",\"text\":\"\"},on:{\"click\":function($event){return _vm.toSync(record.scope)}}},[_vm._v(\"同步\")]),_vm._v(\" \"),_c('bk-button',{staticClass:\"mr10\",attrs:{\"theme\":\"primary\",\"text\":\"\"},on:{\"click\":function($event){return _vm.toMap(record.scope)}}},[_vm._v(\"属性映射\")]),_vm._v(\" \"),_c('bk-popconfirm',{attrs:{\"trigger\":\"click\",\"title\":\"确认删除该名单？\",\"content\":\"删除操作无法撤回，请谨慎操作！\"},on:{\"confirm\":function($event){return _vm.toDelete(record.scope)}}},[_c('bk-button',{staticClass:\"mr10\",attrs:{\"theme\":\"primary\",\"text\":\"\"}},[_vm._v(\"剔除\")])],1)]}}])})],1),_vm._v(\" \"),_c('bk-dialog',{attrs:{\"theme\":\"primary\",\"mask-close\":false,\"header-position\":'left',\"title\":\"同步周期设置\"},model:{value:(_vm.periodSettingVisible),callback:function ($$v) {_vm.periodSettingVisible=$$v},expression:\"periodSettingVisible\"}},[_c('bk-form',{ref:\"validateForm\",attrs:{\"label-width\":80,\"model\":_vm.editPeriod,\"rules\":_vm.syncRules}},[_c('bk-form-item',{attrs:{\"label\":\"同步时间\",\"required\":true,\"property\":'last_time',\"error-display-type\":'normal'}},[_c('bk-date-picker',{attrs:{\"placeholder\":'选择日期时间',\"type\":'datetime'},model:{value:(_vm.editPeriod.last_time),callback:function ($$v) {_vm.$set(_vm.editPeriod, \"last_time\", $$v)},expression:\"editPeriod.last_time\"}})],1),_vm._v(\" \"),_c('bk-form-item',{staticStyle:{\"float\":\"left\",\"width\":\"180px\"},attrs:{\"label\":\"同步周期\",\"required\":true,\"property\":'period',\"error-display-type\":'normal'}},[_c('bk-input',{model:{value:(_vm.editPeriod.period),callback:function ($$v) {_vm.$set(_vm.editPeriod, \"period\", $$v)},expression:\"editPeriod.period\"}})],1),_vm._v(\" \"),_c('bk-form-item',{staticClass:\"sync-period\",staticStyle:{\"float\":\"left\",\"width\":\"150px\"},attrs:{\"label\":\"\",\"property\":'value'}},[_c('div',{staticStyle:{\"float\":\"left\"}},[_c('bk-select',{staticStyle:{\"width\":\"150px\",\"margin-left\":\"10px\"},attrs:{\"clearable\":false,\"disabled\":false,\"ext-cls\":\"select-custom\",\"ext-popover-cls\":\"select-popover-custom\"},model:{value:(_vm.editPeriod.value),callback:function ($$v) {_vm.$set(_vm.editPeriod, \"value\", $$v)},expression:\"editPeriod.value\"}},_vm._l((_vm.periodList),function(option){return _c('bk-option',{key:option.id,attrs:{\"id\":option.id,\"name\":option.name}})}),1)],1)])],1),_vm._v(\" \"),_c('div',{attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('bk-button',{attrs:{\"theme\":\"primary\",\"title\":\"确定\",\"loading\":_vm.isConfirm},on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.periodSubmit.apply(null, arguments)}}},[_vm._v(\"确定\")]),_vm._v(\" \"),_c('bk-button',{attrs:{\"theme\":\"default\",\"title\":\"取消\"},on:{\"click\":function($event){_vm.periodSettingVisible = false}}},[_vm._v(\"\\n                取消\\n            \")])],1)],1),_vm._v(\" \"),_c('bk-dialog',{attrs:{\"theme\":\"primary\",\"mask-close\":false,\"header-position\":'left',\"title\":\"新增模型\"},model:{value:(_vm.modelVisible),callback:function ($$v) {_vm.modelVisible=$$v},expression:\"modelVisible\"}},[_c('bk-form',{ref:\"CMDBForm\",attrs:{\"label-width\":130,\"model\":_vm.modelFormData,\"rules\":_vm.rules}},[_c('bk-form-item',{attrs:{\"label\":\"选择模型\",\"required\":true,\"property\":'model_id',\"error-display-type\":'normal'}},[_c('bk-select',{ref:\"modeSelect\",staticStyle:{\"width\":\"222px\"},attrs:{\"disabled\":false,\"ext-cls\":\"select-custom\",\"ext-popover-cls\":\"select-popover-custom\",\"searchable\":\"\"},on:{\"change\":_vm.changeClick},model:{value:(_vm.modelFormData.model_id),callback:function ($$v) {_vm.$set(_vm.modelFormData, \"model_id\", $$v)},expression:\"modelFormData.model_id\"}},_vm._l((_vm.CMDBList),function(option){return _c('bk-option',{key:option.model_id,attrs:{\"id\":option.model_id,\"name\":option.name}})}),1)],1),_vm._v(\" \"),_c('bk-form-item',{attrs:{\"label\":\"指定IP字段\",\"required\":true,\"property\":'ip',\"error-display-type\":'normal'}},[_c('bk-select',{staticStyle:{\"width\":\"222px\"},attrs:{\"disabled\":false,\"ext-cls\":\"select-custom\",\"ext-popover-cls\":\"select-popover-custom\"},model:{value:(_vm.modelFormData.ip),callback:function ($$v) {_vm.$set(_vm.modelFormData, \"ip\", $$v)},expression:\"modelFormData.ip\"}},_vm._l((_vm.ipList),function(option){return _c('bk-option',{key:option.bk_property_id,attrs:{\"id\":option.bk_property_id,\"name\":option.bk_property_name}})}),1)],1),_vm._v(\" \"),_c('bk-form-item',{attrs:{\"label\":\"指定云区域字段\",\"property\":'bk_cloud_id'}},[_c('bk-select',{staticStyle:{\"width\":\"222px\"},attrs:{\"disabled\":false,\"ext-cls\":\"select-custom\",\"ext-popover-cls\":\"select-popover-custom\"},model:{value:(_vm.modelFormData.bk_cloud_id),callback:function ($$v) {_vm.$set(_vm.modelFormData, \"bk_cloud_id\", $$v)},expression:\"modelFormData.bk_cloud_id\"}},_vm._l((_vm.cloudList),function(option){return _c('bk-option',{key:option.bk_property_id,attrs:{\"id\":option.bk_property_id,\"name\":option.bk_property_name}})}),1)],1),_vm._v(\" \"),_c('bk-form-item',{attrs:{\"label\":\"同步优先级\",\"required\":true,\"property\":'priority',\"error-display-type\":'normal'}},[_c('bk-input',{attrs:{\"placeholder\":\"仅支持数字，且优先级唯一\"},model:{value:(_vm.modelFormData.priority),callback:function ($$v) {_vm.$set(_vm.modelFormData, \"priority\", $$v)},expression:\"modelFormData.priority\"}})],1),_vm._v(\" \"),_c('bk-form-item',{attrs:{\"label\":\"启动同步\",\"required\":true,\"property\":'sync',\"error-display-type\":'normal'}},[_c('bk-switcher',{model:{value:(_vm.modelFormData.sync),callback:function ($$v) {_vm.$set(_vm.modelFormData, \"sync\", $$v)},expression:\"modelFormData.sync\"}})],1)],1),_vm._v(\" \"),_c('div',{attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('bk-button',{attrs:{\"theme\":\"primary\",\"title\":\"确定\",\"loading\":_vm.isConfirm},on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.modelSubmit.apply(null, arguments)}}},[_vm._v(\"确定\")]),_vm._v(\" \"),_c('bk-button',{attrs:{\"theme\":\"default\",\"title\":\"取消\"},on:{\"click\":function($event){_vm.modelVisible = false}}},[_vm._v(\"\\n                取消\\n            \")])],1)],1),_vm._v(\" \"),_c('bk-dialog',{attrs:{\"theme\":\"primary\",\"mask-close\":false,\"header-position\":'left',\"title\":\"属性映射\"},model:{value:(_vm.mapVisible),callback:function ($$v) {_vm.mapVisible=$$v},expression:\"mapVisible\"}},[_c('table',{staticStyle:{\"text-align\":\"center\"}},[_c('tr',[_c('td'),_vm._v(\" \"),_c('td',{attrs:{\"width\":\"100px\"}},[_vm._v(\"IPAM属性\")]),_vm._v(\" \"),_c('td'),_vm._v(\" \"),_c('td',[_vm._v(\"CMDB属性\")]),_vm._v(\" \"),_c('td',[_vm._v(\"同步冲突检测\")])]),_vm._v(\" \"),_vm._l((_vm.mapList),function(item,index){return _c('tr',{key:index},[_c('td',{staticStyle:{\"text-align\":\"right\"}},[(index !== 0)?_c('bk-icon',{attrs:{\"type\":\"minus-circle\"},on:{\"click\":function($event){return _vm.reduceMap(index)}}}):_vm._e(),_vm._v(\" \"),_c('bk-icon',{attrs:{\"type\":\"plus-circle\"},on:{\"click\":function($event){return _vm.addMap(index)}}})],1),_vm._v(\" \"),_c('td',[_c('bk-select',{staticStyle:{\"width\":\"100px\"},attrs:{\"disabled\":false,\"ext-cls\":\"select-custom\",\"ext-popover-cls\":\"select-popover-custom\",\"searchable\":\"\"},model:{value:(item.ipam_attr),callback:function ($$v) {_vm.$set(item, \"ipam_attr\", $$v)},expression:\"item.ipam_attr\"}},_vm._l((_vm.IPAMList),function(option){return _c('bk-option',{key:option.bk_property_id,attrs:{\"id\":option.bk_property_id,\"name\":option.bk_property_id}})}),1)],1),_vm._v(\" \"),_c('td',[_c('bk-icon',{attrs:{\"type\":\"arrows-left\"}})],1),_vm._v(\" \"),_c('td',[_c('bk-select',{staticStyle:{\"width\":\"100px\"},attrs:{\"disabled\":false,\"ext-cls\":\"select-custom\",\"ext-popover-cls\":\"select-popover-custom\",\"searchable\":\"\"},on:{\"change\":function (newVaule) { return _vm.CMDBClick(newVaule, item); }},model:{value:(item.cmdb_attr),callback:function ($$v) {_vm.$set(item, \"cmdb_attr\", $$v)},expression:\"item.cmdb_attr\"}},_vm._l((_vm.attrList),function(option){return _c('bk-option',{key:option.bk_property_id,attrs:{\"id\":option.bk_property_id,\"name\":option.bk_property_name}})}),1)],1),_vm._v(\" \"),_c('td',[_c('bk-checkbox',{model:{value:(item.check_conflict),callback:function ($$v) {_vm.$set(item, \"check_conflict\", $$v)},expression:\"item.check_conflict\"}})],1)])})],2),_vm._v(\" \"),_c('div',{attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('bk-button',{attrs:{\"theme\":\"primary\",\"title\":\"保存\",\"loading\":_vm.isConfirm},on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.mapSubmit.apply(null, arguments)}}},[_vm._v(\"保存\")]),_vm._v(\" \"),_c('bk-button',{attrs:{\"theme\":\"default\",\"title\":\"取消\"},on:{\"click\":function($event){_vm.mapVisible = false}}},[_vm._v(\"\\n                取消\\n            \")])],1)])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }"],"sourceRoot":""}